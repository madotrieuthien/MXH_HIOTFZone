@model List<MXH_HIOTFZone.Models.NguoiDung>

@{
    ViewBag.Title = "Quản lý tài khoản";
    Layout = null;   // Không dùng layout
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #f3f4f6;
            font-family: 'Segoe UI', sans-serif;
        }

        .admin-header {
            background: linear-gradient(90deg, #3b82f6, #06b6d4);
            padding: 20px;
            color: white;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

            .admin-header h2 {
                margin: 0;
                font-weight: 600;
            }
    </style>
</head>

<body>

    <!-- HEADER ADMIN -->
    <div class="admin-header">
        <h2>Quản lý tài khoản người dùng</h2>
        

        <div class="mt-1">
            Admin: <strong>@Session["AdminHoTen"]</strong>
        </div>
    </div>

    <div class="container">

        <h2 class="mb-4">Quản lý tài khoản</h2>
        <!-- FORM LỌC -->
        <form method="get" class="row g-3 mb-4">

            <!-- Lọc theo tên -->
            <div class="col-md-4">
                <input type="text" name="keyword"
                       class="form-control"
                       placeholder="Tìm theo tên..."
                       value="@Request["keyword"]" />
            </div>

            <!-- Lọc theo trạng thái -->
            <div class="col-md-3">
                <select name="status" class="form-select">
                    <option value="">-- Trạng thái --</option>
                    <option value="active" @(Request["status"] == "active" ? "selected" : "")>
                        Hoạt động
                    </option>
                    <option value="locked" @(Request["status"] == "locked" ? "selected" : "")>
                        Bị khóa
                    </option>
                </select>
            </div>

            <!-- Lọc theo số lần cảnh báo -->
            <div class="col-md-3">
                <select name="warning" class="form-select">
                    <option value="">-- Cảnh báo --</option>
                    <option value="0" @(Request["warning"] == "0" ? "selected" : "")>0 lần</option>
                    <option value="1" @(Request["warning"] == "1" ? "selected" : "")>1 lần</option>
                    <option value="2" @(Request["warning"] == "2" ? "selected" : "")>2 lần</option>
                    <option value="3" @(Request["warning"] == "3" ? "selected" : "")>3+ lần</option>
                </select>
            </div>

            <!-- Nút lọc -->
            <div class="col-md-2 d-grid">
                <button class="btn btn-primary">Lọc</button>
            </div>
        </form>
        <table class="table table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Avatar</th>
                    <th>Tên</th>
                    <th>Ngày tham gia</th>
                    <th>Cảnh báo</th>
                    <th>Trạng thái</th>
                    <th>Thao tác</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var u in Model)
                {
                    <tr>
                        <td>
                            <img src="/Images/Avatar/@u.Avatar"
                                 class="rounded-circle" style="width:45px;height:45px;" />
                        </td>

                        <td>@u.TenNguoiDung</td>

                        <td>@u.NgayTao.Value.ToString("dd/MM/yyyy")</td>

                        <td>
                            <span class="badge bg-warning text-dark">
                                Cảnh báo: @u.SoLanCanhCao lần
                            </span>
                        </td>

                        <td>
                            @if (u.TrangThaiTaiKhoan == true)
                            {
                                <span class="badge bg-danger">Đã khóa</span>
                            }
                            else
                            {
                                <span class="badge bg-success">Hoạt động</span>
                            }
                        </td>

                        <td>
                            @if (u.SoLanCanhCao < 3)
                            {
                                <a href="@Url.Action("CanhBao", new { id = u.NguoiDungID })"
                                   class="btn btn-sm btn-warning">
                                    Cảnh báo lần @u.SoLanCanhCao
                                </a>
                            }
                            else
                            {
                                <button class="btn btn-sm btn-secondary" disabled>
                                    Đã cảnh báo @u.SoLanCanhCao/3
                                </button>
                            }

                            @if (u.TrangThaiTaiKhoan == true)
                            {
                                <a href="@Url.Action("MoKhoa", new { id = u.NguoiDungID })"
                                   class="btn btn-sm btn-success">Mở khóa</a>
                            }
                            else
                            {
                                <a href="@Url.Action("Khoa", new { id = u.NguoiDungID })"
                                   class="btn btn-sm btn-danger">Khóa</a>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
        <div class="text-center mt-4 mb-5">
            <a href="@Url.Action("Admin","HIOTFZone")" class="btn btn-secondary px-4 py-2">
                ⬅ Quay lại trang Admin
            </a>
        </div>

    </div>

</body>
</html>
